<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>API Servlet</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/reveal.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/theme/white.css" id="theme"><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/lib/css/zenburn.css" rel="stylesheet"><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/print/pdf.css" : "https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/lib/js/html5shiv.js"></script><![endif]--><link rel="stylesheet" href="style.css"></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>API Servlet</h1></section><section><section id="_définition"><h2>Définition</h2><div class="quoteblock"><blockquote>Java component that extends the capabilities of a server.</blockquote><div class="attribution"><cite>https://en.wikipedia.org/wiki/Java_servlet</cite><br>&#8212; Wikipedia</div></div><div class="paragraph"><p>Partie intégrante d&#8217;une application web</p></div></section><section id="_application_web"><h2>Application web</h2><div class="ulist"><ul><li><p>Web archive - WAR</p></li><li><p>Structure spécifique</p></li></ul></div></section><section><div class="imageblock stretch" style=""><img src="./images/servlet/web-module.gif" alt="web module" height="100%"></div></section><section id="_accessibilité_des_resources"><h2>Accessibilité des resources</h2><div class="ulist"><ul><li><p>Dans <code>WEB-INF</code>, inaccessible en HTTP</p></li><li><p>En dehors de <code>WEB-INF</code>, accessible en HTTP via le chemin vers la ressource :</p><div class="ulist"><ul><li><p><code>/page/hello.html</code> est accessible via <a href="http://domain:port/page/hello.html" class="bare">http://domain:port/page/hello.html</a></p></li></ul></div></li></ul></div></section></section>
<section><section id="_descripteur_de_déploiement"><h2>Descripteur de déploiement</h2><div class="ulist"><ul><li><p>Pages d&#8217;accueil</p></li><li><p>Déclaration de servlets</p></li><li><p>Déclaration de filtres</p></li><li><p>Paramètres d&#8217;initialisation</p></li><li><p>etc.</p></li></ul></div></section><section id="_web_xml"><h2>web.xml</h2><div class="ulist"><ul><li><p>Situé dans répertoire <code>WEB-INF</code></p></li><li><p>Référence un schéma XSD</p></li><li><p>Dépend de la version de Java EE</p></li><li><p>Optionnel !</p></li></ul></div></section><section><pre class="highlight listingblock"><code class="xml language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app
  xmlns="http://xmlns.jcp.org/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    http://xmlns.jcp.org/xml/ns/javaee
    http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
  version="3.1"&gt;
&lt;/web-app&gt;</code></pre></section></section>
<section><section id="_composant_servlet"><h2>Composant servlet</h2><div class="ulist"><ul><li><p>Corrélé à une URL</p></li><li><p>Modèle requête réponse :</p><div class="ulist"><ul><li><p>Activé par l&#8217;envoi d&#8217;une requête</p></li><li><p>Retourne (souvent) une réponse</p></li></ul></div></li></ul></div></section><section id="_cycle_de_vie"><h2>Cycle de vie</h2><div class="ulist"><ul><li><p>Le cycle de vie est géré par le serveur d&#8217;applications</p><div class="olist arabic"><ol class="arabic"><li><p>Instanciation</p></li><li><p>Service</p></li><li><p>Destruction</p></li></ol></div></li><li><p>Il peut exister <em>n</em> instances à un moment <em>t</em></p></li><li><p>On ne sait pas quelle instance est appelée</p></li></ul></div></section><section><div class="imageblock" style=""><img src="./images/servlet/servlet-sequence.svg" alt="servlet sequence"></div></section><section id="_mapping_durl"><h2>Mapping d&#8217;URL</h2><div class="ulist"><ul><li><p>Double lien :</p><div class="ulist"><ul><li><p>URL - Nom logique</p></li><li><p>Nom logique - Classe pleinement qualifiée</p></li></ul></div></li></ul></div></section><section id="_via_le_descripteur"><h2>Via le descripteur</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;web...&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;HelloWorld&lt;/servlet-name&gt;
    &lt;servlet-class&gt;ch.frankel.HelloServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;HelloWorld&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
&lt;/web&gt;</code></pre></section><section id="_via_les_annotations"><h2>Via les annotations</h2><pre class="highlight listingblock"><code class="java language-java">package ch.frankel;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet { ... }</code></pre></section><section id="_modèles_durl"><h2>Modèles d&#8217;URL</h2><div class="olist arabic"><ol class="arabic"><li><p>Strict, par exemple <code>/hello</code></p></li><li><p>Générique, mais limité :</p><div class="ulist"><ul><li><p><code>/hello/*</code></p></li><li><p><code>*.do</code></p></li></ul></div></li><li><p>Spécifiques :</p><div class="ulist"><ul><li><p><code>/*</code></p></li><li><p><code>/</code></p></li></ul></div></li></ol></div></section><section><div class="imageblock" style=""><img src="./images/servlet/servlet.svg" alt="servlet"></div></section><section id="_implémentation_de_servlet"><h2>Implémentation de servlet</h2><div class="olist arabic"><ol class="arabic"><li><p>Créer une classe enfant de <code>HttpServlet</code></p></li><li><p>Implémenter la méthode qui correspond au verbe HTTP désiré</p><div class="ulist"><ul><li><p><code>doGet()</code></p></li><li><p><code>doPost()</code></p></li><li><p>etc.</p></li></ul></div></li></ol></div></section></section>
<section><section id="_http_servlet_response"><h2>Http Servlet Response</h2><div class="paragraph"><p>Représentation Java d&#8217;une réponse HTTP :</p></div><div class="ulist"><ul><li><p>Envoi d’un code erreur HTTP</p></li><li><p>Redirection vers une autre URL</p></li><li><p>Gestion des en-têtes HTTP</p></li><li><p>Gestion des cookies</p></li><li><p>Ecriture :</p><div class="ulist"><ul><li><p>de caractères (texte)</p></li><li><p>d’octets (binaire)</p></li></ul></div></li></ul></div></section><section><div class="imageblock" style=""><img src="./images/servlet/servlet-response.svg" alt="servlet response"></div></section><section id="_envoi_de_code_derreur"><h2>Envoi de code d&#8217;erreur</h2><pre class="highlight listingblock"><code class="java language-java">public class SendErrorServlet extends HttpServlet {

    @Override
    public void doGet(HttpServletRequest req,
                      HttpServletResponse res) {
        res.sendError(500);
    }
}</code></pre></section><section id="_redirection"><h2>Redirection</h2><div class="ulist"><ul><li><p>Le navigateur reçoit un code HTTP <em>30x</em> :</p><div class="ulist"><ul><li><p>Lecture de l&#8217;URL configurée dans l&#8217;en-tête HTTP <code>Location</code></p></li><li><p>Nouvelle requête <code>GET</code> à cette URL</p></li></ul></div></li></ul></div></section><section id="_redirection_2"><h2>Redirection</h2><div class="imageblock stretch" style=""><img src="./images/servlet/redirect.svg" alt="redirect" height="100%"></div></section><section id="_types_de_redirection"><h2>Types de redirection</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Type</th><th class="tableblock halign-left valign-top">Code statut HTTP</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><em>Permanent</em></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">301</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><em>Temporary</em></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">302</p></td></tr></table></section><section id="_redirection_3"><h2>Redirection</h2><pre class="highlight listingblock"><code class="java language-java">public class RedirectServlet extends HttpServlet {

    @Override
    public void doGet(HttpServletRequest req,
                      HttpServletResponse resp) {
        resp.sendRedirect("https://www.google.com");
    }
}</code></pre></section><section id="_print_writer"><h2>Print Writer</h2><div class="ulist"><ul><li><p>Permet d&#8217;écrire du texte dans le flux de réponse</p></li><li><p>Nécessite de spécifier le type MIME</p></li></ul></div></section><section id="_print_writer_2"><h2>Print Writer</h2><pre class="highlight listingblock"><code class="java language-java">public class PrintServlet extends HttpServlet {

    @Override
    public void doGet(HttpServletRequest req,
                      HttpServletResponse resp) {
        resp.setContentType("text/html");
        PrintWriter out = resp.getWriter();
        out.println("&lt;html&gt;&lt;body&gt;");
        out.println("Hello world!");
        out.println("&lt;/body&gt;&lt;/html&gt;");
    }
}</code></pre></section><section id="_output_stream"><h2>Output Stream</h2><div class="ulist"><ul><li><p>Permet d&#8217;écrire des octets dans le flux de réponse</p></li><li><p>Nécessite de spécifier le type MIME</p></li><li><p>Génération dynamique :</p><div class="ulist"><ul><li><p>d&#8217;images</p></li><li><p>de tableaux Excel</p></li><li><p>etc.</p></li></ul></div></li></ul></div></section></section>
<section><section id="_http_servlet_request"><h2>Http Servlet Request</h2><div class="paragraph"><p>Représentation Java d&#8217;une requête HTTP :</p></div><pre class="highlight listingblock"><code>GET /java/index.html HTTP/1.1
Host: formations.github.io
Accept: image/gif, image/jpeg, */*
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)</code></pre></section><section id="_api"><h2>API</h2><div class="ulist"><ul><li><p>Analyse de la requête :</p><div class="ulist"><ul><li><p>Accès à l&#8217;URL (protocole, domaine, paramètres, etc.)</p></li><li><p>Accès aux cookies</p></li><li><p>Accès aux en-têtes HTTP</p></li></ul></div></li><li><p>Accès à la session HTTP</p></li><li><p>Accès au <code>RequestDispatcher</code></p></li></ul></div></section><section><div class="imageblock" style=""><img src="./images/servlet/servlet-request.svg" alt="servlet request"></div></section><section id="_url"><h2>URL</h2><div class="imageblock" style=""><img src="./images/servlet/complex_url.png" alt="complex url"></div></section></section>
<section><section id="_request_dispatcher"><h2>Request Dispatcher</h2><div class="ulist"><ul><li><p>Fait suivre la chaîne de traitement au prochain servlet</p></li><li><p>Inclut la réponse du prochain servlet dans le flux actuel</p></li></ul></div></section><section id="_utilisation_du_request_dispatcher"><h2>Utilisation du Request Dispatcher</h2><pre class="highlight listingblock"><code class="java language-java">public class ForwardServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req,
                         HttpServletResponse resp)
                   throws ServletException, IOException {

        req.getRequestDispatcher("/resource")
                          .forward(req, resp);
    }
}</code></pre></section><section><div class="imageblock stretch" style=""><img src="./images/servlet/rd-forward-include.svg" alt="rd forward include" height="100%"></div></section></section>
<section><section id="_java_server_pages"><h2>Java Server Pages</h2><div class="ulist"><ul><li><p>Ecrire du HTML via le <code>PrintWriter</code> est laborieux</p></li><li><p>Prévisualisation impossible pour les web designers</p></li></ul></div></section><section id="_composant_jsp"><h2>Composant JSP</h2><div class="ulist"><ul><li><p>Format texte</p></li><li><p>Au premier appel, le container :</p><div class="ulist"><ul><li><p>Translate la JSP en servlet</p></li><li><p>Compile le servlet</p></li></ul></div></li></ul></div></section><section id="_exemple_de_jsp"><h2>Exemple de JSP</h2><pre class="highlight listingblock"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello world&lt;/title&gt;
&lt;body&gt;
  &lt;% Object n = request.getAttribute("name"); %&gt;
  Hello &lt;% out.println(n); %&gt;
&lt;/body&gt;</code></pre></section><section id="_un_autre_exemple"><h2>Un autre exemple</h2><pre class="highlight listingblock"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello world&lt;/title&gt;
&lt;body&gt;
  Hello &lt;%= request.getAttribute("name") %&gt;
&lt;/body&gt;</code></pre></section><section id="_un_dernier_exemple"><h2>Un dernier exemple</h2><pre class="highlight listingblock"><code>&lt;%@ taglib uri="http://java.sun.com/jstl/core" prefix="c" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello world&lt;/title&gt;
&lt;body&gt;
  Hello &lt;c:out value="requestScope.name" /&gt;
&lt;/body&gt;</code></pre></section><section id="_scriptlet"><h2>Scriptlet</h2><div class="ulist"><ul><li><p>N&#8217;importe quel code Java</p></li><li><p>Balisé par <code>&lt;%</code> et <code>%&gt;</code></p></li></ul></div></section><section id="_expression"><h2>Expression</h2><div class="ulist"><ul><li><p>Equivalent à <code>out.println()</code></p></li><li><p>Balisé par <code>&lt;%=</code> et <code>%&gt;</code></p></li></ul></div></section><section id="_directives"><h2>Directives</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Type</th><th class="tableblock halign-left valign-top">Exemple</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Import</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;%@page import="java.util.List" %&gt;</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Inclusion</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;%@include file="response.jsp" %&gt;</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Taglib</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;%@taglib uri="http://java.sun.com/jstl/core" prefix="c" %&gt;</code></p></td></tr></table></section><section id="_commentaires"><h2>Commentaires</h2><div class="ulist"><ul><li><p>Ignoré dans le processus de compilation</p></li><li><p>Ne sera pas disponible dans le HTML généré</p></li><li><p>Balisé par <code>&lt;%--</code> et <code>--%&gt;</code></p></li></ul></div></section><section id="_déclarations"><h2>Déclarations</h2><div class="ulist"><ul><li><p>Déclaration de méthodes et d&#8217;attributs</p></li><li><p>Pour information (très peu utilisé)</p></li><li><p>Balisé par <code>&lt;%!</code> et <code>%&gt;</code></p></li></ul></div></section><section id="_objets_implicites"><h2>Objets implicites</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Variable</th><th class="tableblock halign-left valign-top">Type</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>out</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>JspWriter</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>request</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpServletRequest</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>response</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpServletResponse</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>config</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletConfig</code></p></td></tr></table></section><section><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Variable</th><th class="tableblock halign-left valign-top">Type</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>application</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletContext</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>session</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpSession</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>pageContext</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>PageContext</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>page</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"> <code>exception</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>Throwable</code></p></td></tr></table></section><section id="_modèle_vue_contrôleur"><h2>Modèle Vue Contrôleur</h2><div class="paragraph"><p>Principe de séparation des responsabilités</p></div></section><section><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:14.2857%"><col style="width:28.5714%"><col style="width:57.1429%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Rôle</th><th class="tableblock halign-left valign-top">Composant</th><th class="tableblock halign-left valign-top">Fonctionnalité</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Contrôleur</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Servlet</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Gère le flux de contrôle</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Vue</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">JSP</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Affiche la page</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Modèle</p></td><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>JavaBean</p></li><li><p>EJB</p></li><li><p>etc.</p></li></ul></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">Gère les données</p></td></tr></table></section><section><div class="imageblock stretch" style=""><img src="./images/servlet/mvc.svg" alt="mvc" height="100%"></div></section></section>
<section><section id="_attributs_de_requête"><h2>Attributs de requête</h2><div class="ulist"><ul><li><p>Comment transférer des données au travers du pipeline de traitement d&#8217;une requête ?</p></li><li><p>Par exemple, du contrôleur (servlet) à la vue (JSP)</p></li></ul></div></section><section id="_exemple_de_formulaire_denregistrement"><h2>Exemple de formulaire d&#8217;enregistrement</h2><div class="ulist"><ul><li><p>Servlet dédié au traitement des données (validation, enregistrement, etc.)</p></li><li><p>JSP dédiée à l&#8217;affichage du HTML</p><div class="ulist"><ul><li><p>"Bravo <em>M. Dupont</em>, vous avez bien été enregistré"</p></li></ul></div></li><li><p>Il faut transférer les données (titre et nom) du servlet à la JSP</p></li></ul></div></section><section id="_utilisation_des_attributs"><h2>Utilisation des attributs</h2><div class="ulist"><ul><li><p>A chaque <code>HttpServletRequest</code> est associée une <code>Map&lt;String, Object&gt;</code>.</p><div class="olist arabic"><ol class="arabic"><li><p>Le servlet stocke l&#8217;objet comme attribut de requête sous la clé <code>key</code></p></li><li><p>Le servlet <em>forward</em> à la JSP</p></li><li><p>La JSP récupère l&#8217;attribut de requête sous la clé <code>key</code></p></li><li><p>Le transtype dans le type correct</p></li></ol></div></li></ul></div></section><section id="_périmètre_des_attributs"><h2>Périmètre des attributs</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:33.3333%"><col style="width:33.3334%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Nom</th><th class="tableblock halign-left valign-top">Objet</th><th class="tableblock halign-left valign-top">Objet implicite JSP</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Application</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletContext</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>application</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Session</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpSession</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>session</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Requête</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpServletRequest</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>request</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Page</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>PageContext</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>page</code></p></td></tr></table></section></section>
<section><section id="_session"><h2>Session</h2><div class="ulist"><ul><li><p>HTTP est un protocole déconnecté</p><div class="ulist"><ul><li><p>Impossible de savoir si 2 requêtes proviennent de la même session navigateur</p></li><li><p>Utilisation d&#8217;un cookie <code>JSESSIONID</code></p></li></ul></div></li><li><p>Cookie géré automatiquement par le serveur d&#8217;applications</p></li></ul></div></section><section id="_http_session"><h2>Http Session</h2><div class="ulist"><ul><li><p>Ensemble d&#8217;attributs spécifiques à une session navigateur</p></li><li><p>Stockés en mémoire</p></li><li><p>Attention :</p><div class="ulist"><ul><li><p>Aux collections sans limite de taille</p></li><li><p>Aux objets de taille trop importante</p></li></ul></div></li></ul></div></section><section><div class="imageblock" style=""><img src="./images/servlet/session.svg" alt="session"></div></section><section><pre class="highlight listingblock"><code class="java language-java">HttpSession session = req.getSession();
session.setAttribute("person", new Person("John", "Doe"));

// in another component (servlet, jsp, filter)
Object object = session.getAttribute("person");
Person person = (Person) object;</code></pre></section></section>
<section><section id="_taglibs_tag_files_et_expression_language"><h2>Taglibs, tag files et Expression Language</h2></section><section id="_le_problème_des_scriptlets"><h2>Le problème des scriptlets</h2><div class="ulist"><ul><li><p>Dans le modèle MVC, la JSP joue le rôle de vue</p></li><li><p>Mais les scriptlets permettent tout</p><div class="ulist"><ul><li><p>Par exemple, d&#8217;accéder à la base de données</p></li></ul></div></li></ul></div></section><section id="_solution"><h2>Solution</h2><div class="ulist"><ul><li><p>Une spécification décrit comment créer une librairie</p></li><li><p>La librairie comporte des fonctionnalités spécifiques</p></li><li><p>Intégrable dans les JSPs</p></li></ul></div></section><section><table class="tableblock frame-all grid-all" style=""><colgroup><col><col></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Taglib</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Balise XML à laquelle est associée une classe Java compilée</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Tag file</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Balise XML à laquelle est associée un fichier <code>.tag</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Expression Language - EL</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Exécute du code arbitraire</p></td></tr></table></section><section id="_exemples_dexpressions_el"><h2>Exemples d&#8217;expressions EL</h2><div class="ulist"><ul><li><p><code>${sessionScope.cart.numberOfItems}</code></p></li><li><p><code>${param['mycom.productId']}</code></p></li><li><p><code>${requestScope['javax.servlet.forward.servlet_path']}</code></p></li><li><p><code>${!empty param.Add}</code></p></li><li><p>etc.</p></li></ul></div></section><section id="_taglib"><h2>Taglib</h2><div class="paragraph"><p>Spécifiée par un fichier Tag Library Descriptor</p></div>
<div class="ulist"><ul><li><p>Dans le répertoire <code>META-INF</code> du JAR de taglib</p></li><li><p>Référence les classes de Taglib</p></li></ul></div></section><section id="_exemple_de_taglib"><h2>Exemple de taglib</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;taglib xmlns="urn:foo:bar"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://foo.bar/bar.xsd"
        version="2.1"&gt;
  &lt;display-name&gt;Foo Bar&lt;/display-name&gt;
  &lt;tlib-version&gt;1.0&lt;/tlib-version&gt;
  &lt;short-name&gt;foo&lt;/short-name&gt;
  &lt;uri&gt;http://foo.com/bar&lt;/uri&gt;
  &lt;tag&gt;
    &lt;name&gt;bar&lt;/name&gt;
    &lt;tag-class&gt;ch.frankel.BarTag&lt;/tag-class&gt;
    &lt;body-content&gt;scriptless&lt;/body-content&gt;
    &lt;attribute&gt;
        &lt;name&gt;baz&lt;/name&gt;
        &lt;required&gt;false&lt;/required&gt;
        &lt;rtexprvalue&gt;false&lt;/rtexprvalue&gt;
    &lt;/attribute&gt;
  &lt;/tag&gt;
&lt;/taglib&gt;</code></pre></section><section id="_exemple_dutilisation"><h2>Exemple d&#8217;utilisation</h2><div class="title">example.jsp</div><pre class="highlight listingblock"><code class="jsp language-jsp">&lt;%@ taglib uri="http://foo.com/bar" prefix="foo" %&gt;
&lt;html&gt;
  &lt;body&gt;
    &lt;foo:bar baz="hello"&gt;
      &lt;h1&gt;Title&lt;/h1&gt;
    &lt;/foo:bar&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre></section><section id="_hiérarchie_des_classes"><h2>Hiérarchie des classes</h2><div class="imageblock stretch" style=""><img src="./images/servlet/tag.svg" alt="tag" height="100%"></div></section><section id="_java_standard_taglibs_jstl"><h2>Java Standard TagLibs - JSTL</h2><div class="ulist"><ul><li><p>Core - <code>c</code></p></li><li><p>Internationalisation - <code>fmt</code></p></li><li><p>Tag Library Validator - <code>tlv</code></p></li><li><p>(SQL - <code>sql</code>)</p></li></ul></div></section><section id="_fonctionnalités_de_core"><h2>Fonctionnalités de core</h2><div class="ulist"><ul><li><p>Test</p></li><li><p>Itération</p></li><li><p>Affichage</p></li><li><p>etc.</p></li></ul></div></section><section id="_exemple_de_scriptlet"><h2>Exemple de scriptlet</h2><pre class="highlight listingblock"><code class="jsp language-jsp">&lt;% List person = (List) request.getAttribute("persons"); %&gt;
&lt;% for (Person person: persons) { %&gt;
  &lt;%= person.getName() %&gt;
&lt;% } %&gt;</code></pre></section><section id="_equivalent_jstl_el"><h2>Equivalent JSTL + EL</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;c:forEach var="person" items="${requestScope.persons}"&gt;
  &lt;c:out value="${person}" /&gt;
&lt;/c:forEach&gt;</code></pre></section></section>
<section><section id="_filtres_de_servlet"><h2>Filtres de servlet</h2><div class="quoteblock"><blockquote>First, they provide the ability to encapsulate recurring tasks in reusable units. [&#8230;&#8203;] Second, filters can be used to transform the response from a servlet or a JSP page.</blockquote><div class="attribution"><cite>http://www.oracle.com/technetwork/java/filters-137243.html</cite><br>&#8212; Oracle Tech Network</div></div></section><section id="_fonctionnalités_communes"><h2>Fonctionnalités communes</h2><div class="ulist"><ul><li><p>Authentification</p></li><li><p>Logging</p></li><li><p>Conversion d’image</p></li><li><p>Compression de données</p></li><li><p>Cryptage</p></li><li><p>etc.</p></li></ul></div></section><section id="_composant_filtre"><h2>Composant Filtre</h2><div class="ulist"><ul><li><p>Corrélé à une URL</p></li><li><p>Intercepte :</p><div class="ulist"><ul><li><p>Soit la requête</p></li><li><p>Soit la réponse</p></li><li><p>Soit les 2</p></li></ul></div></li></ul></div></section><section><div class="imageblock stretch" style=""><img src="./images/servlet/tfessh-pic-1.gif" alt="tfessh pic 1" height="100%"></div></section><section id="_mapping_durl_2"><h2>Mapping d&#8217;URL</h2><div class="paragraph"><p>Comme pour un servlet</p></div>
<div class="imageblock" style=""><img src="./images/servlet/filter-servlet-mapping.jpg" alt="filter servlet mapping"></div></section><section id="_via_le_descripteur_2"><h2>Via le descripteur</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;web...&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;Authenticate&lt;/filter-name&gt;
    &lt;filter-class&gt;ch.frankel.AuthenticateFilter&lt;/filter-class&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;Authenticate&lt;/filter-name&gt;
    &lt;url-pattern&gt;/secure/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;
&lt;/web&gt;</code></pre></section><section id="_via_les_annotations_2"><h2>Via les annotations</h2><pre class="highlight listingblock"><code class="java language-java">package ch.frankel;

@WebFilter("/secure/*")
public class AuthenticateFilter implements Filter { ... }</code></pre></section><section><div class="imageblock" style=""><img src="./images/servlet/filter.svg" alt="filter"></div></section><section id="_implémentation_de_filtre"><h2>Implémentation de filtre</h2><div class="olist arabic"><ol class="arabic"><li><p>Créer une classe enfant de <code>Filter</code></p></li><li><p>Dans <code>doFilter()</code> :</p><div class="ulist"><ul><li><p>Appeler <code>chain.doFilter()</code> pour passer à la prochaine étape</p></li><li><p>Sinon, le flux s&#8217;arrête là</p></li></ul></div></li></ol></div></section><section id="_exemple_dimplémentation"><h2>Exemple d&#8217;implémentation</h2><pre class="highlight listingblock"><code class="java language-java">@Override
public void doFilter(ServletRequest req,
                     ServletResponse res,
                     FilterChain chain)
                   throws IOException, ServletException {
  HttpServletRequest httpReq = (HttpServletRequest) req;
  HttpSession session = httpReq.getSession();
  if (authenticated(session)) {
    chain.doFilter(req, res);
  } else {
    HttpServletResponse httpRes = (HttpServletResponse) res;
    httpRes.sendError(401, "Not authentified");
  }
}</code></pre></section></section>
<section><section id="_généralités_sur_la_sécurité"><h2>Généralités sur la sécurité</h2><div class="ulist"><ul><li><p>Authentification</p></li><li><p>Autorisations</p></li><li><p>Intégrité des données</p></li><li><p>Confidentialité des données</p></li><li><p>Non-répudiation</p></li><li><p>Audit</p></li></ul></div></section><section id="_restrictions_daccès"><h2>Restrictions d&#8217;accès</h2><div class="ulist"><ul><li><p>Le modèle de sécurité en Java EE 7 est plutôt réduit</p><div class="ulist"><ul><li><p>Authentification et autorisations d&#8217;accès à une URL</p></li></ul></div></li><li><p>La majeure partie de la configuration est propriétaire côté serveur d&#8217;applications</p></li></ul></div></section><section id="_callback"><h2>Callback</h2><div class="ulist"><ul><li><p>Si une URL est protégée</p></li><li><p>Et le client n&#8217;est pas authentifié</p></li><li><p>Alors, déclenchement de la procédure d&#8217;authentification</p></li></ul></div></section><section id="_configuration_du_serveur_dapplications"><h2>Configuration du serveur d&#8217;applications</h2><div class="ulist"><ul><li><p>Utilisateurs</p></li><li><p>Groupes</p></li><li><p>Rôles</p></li></ul></div></section><section><div class="imageblock" style=""><img src="./images/servlet/user-group-role.svg" alt="user group role"></div></section><section id="_déclaration_des_rôles"><h2>Déclaration des rôles</h2><div class="paragraph"><p><code>&lt;security-role&gt;</code> dans le descripteur de déploiement</p></div></section><section><pre class="highlight listingblock"><code class="xml language-xml">&lt;security-role&gt;
    &lt;role-name&gt;ADMIN&lt;/role-name&gt;
&lt;/security-role&gt;</code></pre></section><section id="_configuration_standard"><h2>Configuration standard</h2><div class="paragraph"><p><code>&lt;security-constraint&gt;</code> dans le descripteur de déploiement</p></div>
<table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Type</th><th class="tableblock halign-left valign-top">Balise</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Ressource web</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;web-resource-collection&gt;</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Contrainte d&#8217;autorisation</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;auth-constraint&gt;</code></p></td></tr></table></section><section><pre class="highlight listingblock"><code class="xml language-xml">&lt;security-constraint&gt;
  &lt;web-resource-collection&gt;
    &lt;web-resource-name&gt;Partie sécurisée&lt;/web-resource-name&gt;
    &lt;url-pattern&gt;/secure/*&lt;/url-pattern&gt;
  &lt;/web-resource-collection&gt;
  &lt;auth-constraint&gt;
    &lt;role-name&gt;ADMIN&lt;/role-name&gt;
  &lt;/auth-constraint&gt;
&lt;/security-constraint&gt;</code></pre></section><section id="_modes_dauthentification"><h2>Modes d&#8217;authentification</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Mode</th><th class="tableblock halign-left valign-top">Configuration</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Popup native</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASIC</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Formulaire</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>FORM</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Certificat SSL</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>CLIENT-CERT</code></p></td></tr></table></section><section id="_configuration_native"><h2>Configuration native</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;login-config&gt;
    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
&lt;/login-config&gt;</code></pre></section><section id="_configuration_du_formulaire"><h2>Configuration du formulaire</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;login-config&gt;
  &lt;auth-method&gt;FORM&lt;/auth-method&gt;
  &lt;form-login-config&gt;
    &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;
    &lt;form-error-page&gt;/error.jsp&lt;/form-error-page&gt;
  &lt;/form-login-config&gt;
&lt;/login-config&gt;</code></pre></section><section id="_contraintes_sur_le_formulaire"><h2>Contraintes sur le formulaire</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Composant</th><th class="tableblock halign-left valign-top">Contrainte</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Formulaire</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>action="j_security_check"</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Champ de login</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>name= "j_username"</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Champ de mot de passe</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>name= "j_password"</code></p></td></tr></table></section><section><pre class="highlight listingblock"><code class="html language-html">&lt;form method=post action="j_security_check"&gt;
  &lt;input type="text" name= "j_username" /&gt;
  &lt;input type="password" name= "j_password" /&gt;
  &lt;input type="submit" value="Login" /&gt;
&lt;/form&gt;</code></pre></section><section id="_api_2"><h2>API</h2><div class="ulist"><ul><li><p><code>HttpServletRequest.isUserInRole(String role)</code></p></li><li><p><code>HttpServletRequest.getUserPrincipal()</code></p></li><li><p><code>HttpServletRequest.getRemoteUser()</code></p></li><li><p>(<code>HttpSession.invalidate()</code>)</p></li></ul></div></section></section>
<section><section id="_evènements_java_ee"><h2>Evènements Java EE</h2><div class="ulist"><ul><li><p>Java EE implémente la Programmation Orientée Evènements</p></li><li><p>Divers évènements liés au cycle de vie :</p><div class="ulist"><ul><li><p>Démarrage/arrêt de l&#8217;application</p></li><li><p>Gestion des attributs dans les différents contextes</p></li><li><p>etc.</p></li></ul></div></li><li><p>Possibilité de s&#8217;abonner à ces évènements</p></li></ul></div></section><section id="_evènements_dapplication"><h2>Evènements d&#8217;application</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>ServletContextListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Démarrage de l&#8217;application</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Arrêt de l&#8217;application</p></td></tr></table></section><section id="_evènements_de_contexte_de_servlet"><h2>Evènements de contexte de servlet</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><code>ServletContextAttributeListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ajout d&#8217;attribut</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Suppression d&#8217;attribut</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Remplacement d&#8217;attribut</p></td></tr></table></section><section id="_evènements_de_requête"><h2>Evènements de requête</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>ServletRequestListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Initialisation de la requête</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Destruction de la requête</p></td></tr></table></section><section id="_evènements_de_contexte_de_requête"><h2>Evènements de contexte de requête</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><code>ServletRequestAttributeListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ajout d&#8217;attribut</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Suppression d&#8217;attribut</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Remplacement d&#8217;attribut</p></td></tr></table></section><section id="_evènements_de_session"><h2>Evènements de session</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>HttpSessionListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Création de la session</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Destruction de la session</p></td></tr></table></section><section id="_evènements_de_contexte_de_session"><h2>Evènements de contexte de session</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><code>HttpSessionAttributeListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ajout d&#8217;attribut</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Suppression d&#8217;attribut</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Remplacement d&#8217;attribut</p></td></tr></table></section><section id="_evènements_de_stockage_dans_la_session"><h2>Evènements de stockage dans la session</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>HttpSessionBindingListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Objet stocké en session</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Objet supprimé de la session</p></td></tr></table></section><section id="_evènements_dactivation_de_session"><h2>Evènements d&#8217;activation de session</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Classe associée</th><th class="tableblock halign-left valign-top">Evènement</th></tr><tbody><tr><td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>HttpSessionActivationListener</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Activation de la session</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Déactivation de la session</p></td></tr></table></section><section><div class="imageblock" style=""><img src="./images/servlet/servlet-listener.svg" alt="servlet listener"></div></section><section id="_via_le_descripteur_3"><h2>Via le descripteur</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;web...&gt;
  &lt;listener&gt;
    &lt;listener-class&gt;
      ch.frankel.ASessionListener
    &lt;/listener-class&gt;
  &lt;/listener&gt;
&lt;/web&gt;</code></pre></section><section id="_via_les_annotations_3"><h2>Via les annotations</h2><pre class="highlight listingblock"><code class="java language-java">@WebListener
public class SessionListener implements HttpSessionListener {
}</code></pre></section><section id="_exemple_dimplémentation_2"><h2>Exemple d&#8217;implémentation</h2><pre class="highlight listingblock"><code class="java language-java">@WebListener
public class DatabaseInitializationListener implements ServletContextListener {

  @Override
  public void contextInitialized(ServletContextEvent event) {
    // Create sample data in database
  }

  @Override
  public void contextDestroyed(ServletContextEvent event) {}
}</code></pre></section></section>
<section><section id="_gestion_des_erreurs"><h2>Gestion des erreurs</h2><div class="ulist"><ul><li><p>Gérer les exceptions qui ne sont pas traitées par le servlet</p></li><li><p>De manière transversale</p></li></ul></div></section><section><div class="imageblock" style=""><img src="./images/servlet/500.png" alt="Le serveur a rencontré une erreur qui l'a empêché de servir la requête" width="777" height="523"></div></section><section id="_pages_derreur"><h2>Pages d&#8217;erreur</h2><div class="ulist"><ul><li><p>A chaque type d&#8217;exception</p></li><li><p>Ou à chaque type d&#8217;erreur HTTP</p><div class="ulist"><ul><li><p>Correspond une page d&#8217;erreur</p></li></ul></div></li><li><p>Ou une page d&#8217;erreur <em>catch all</em></p></li></ul></div></section><section id="_configuration"><h2>Configuration</h2><pre class="highlight listingblock"><code class="xml language-xml">&lt;error-page&gt;
    &lt;exception-type&gt;java.lang.NullPointerException&lt;/exception-type&gt;
    &lt;location&gt;/WEB-INF/npe.jsp&lt;/location&gt;
&lt;/error-page&gt;</code></pre></section><section><pre class="highlight listingblock"><code class="xml language-xml">&lt;error-page&gt;
    &lt;error-code&gt;404&lt;/error-code&gt;
    &lt;location&gt;/WEB-INF/404.jsp&lt;/location&gt;
&lt;/error-page&gt;</code></pre></section><section><pre class="highlight listingblock"><code class="xml language-xml">&lt;error-page&gt;
    &lt;location&gt;/WEB-INF/errors.jsp&lt;/location&gt;
&lt;/error-page&gt;</code></pre></section><section id="_tips_tricks"><h2>Tips &amp; tricks</h2><div class="ulist"><ul><li><p>Garder les pages d&#8217;erreur simples</p></li><li><p>Dans la JSP, il est possible d&#8217;accéder à l&#8217;exception via la variable <code>exception</code></p><div class="ulist"><ul><li><p>Nécessite la directive <code>&lt;%@ page isErrorPage="true" %&gt;</code></p></li></ul></div></li></ul></div></section></section>
<section><section id="_internationalisation"><h2>Internationalisation</h2><div class="ulist"><ul><li><p>i18n fait partie de Java SE</p></li><li><p>Mais utilisé dans Java EE</p><div class="ulist"><ul><li><p>Via la librairie JSTL <code>fmt</code></p></li></ul></div></li></ul></div></section><section id="_jstl_fmt"><h2>JSTL fmt</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Tag</th><th class="tableblock halign-left valign-top">Description</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;fmt:setLocale&gt;</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Set la locale depuis une variable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;fmt:setBundle&gt;</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Charge le bundle et le stocke dans une variable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;fmt:message&gt;</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Affiche le message internationalisé</p></td></tr></table></section><section id="_exemple_dutilisation_2"><h2>Exemple d&#8217;utilisation</h2><pre class="highlight listingblock"><code class="html language-html">&lt;%@ taglib prefix="fmt"
           uri="http://java.sun.com/jsp/jstl/fmt" %&gt;

&lt;fmt:setLocale value="${request.locale}" /&gt;
&lt;fmt:setBundle basename="ch.hesge.messages" var="msg" /&gt;

&lt;html&gt;
 &lt;body&gt;
   &lt;ul&gt;
     &lt;li&gt;&lt;fmt:message key="key.one" bundle="${msg}" /&gt;&lt;/li&gt;
     &lt;li&gt;&lt;fmt:message key="key.two" bundle="${msg}" /&gt;&lt;/li&gt;
   &lt;/ul&gt;
 &lt;/body&gt;
&lt;/html&gt;</code></pre></section></section></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/lib/js/head.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'slide',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      
      { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/plugin/zoom-js/zoom.js', async: true },
      { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script></body></html>